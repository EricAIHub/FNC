### 🌟 什么是有效数字损失？

如果你用计算机计算：
$$
x - y, \quad \text{其中 } x \approx y
$$

那么结果会丢失大量有效数字，这叫做：

> **灾难性消去（catastrophic cancellation）**

---

### 🌟 举个真实数值例子

假设机器只能保留 7 位有效数字：

$$
x = 1.2345679, \quad y = 1.2345670
$$


真实结果：

$$
x - y = 0.0000009
$$


但由于前 6 位相同，只有最后一位有用，误差会被极大放大。

---

### 🌟 经典不稳定表达式

考虑：

$$
f(x) = \sqrt{x^2+1} - x
$$


当 $x$ 很大时：

$$
\sqrt{x^2+1} \approx x
$$


于是两个大数相减 → 有效数字几乎全部丢失。

---

### 🌟 稳定改写方法

通过代数变形：

$$
\sqrt{x^2+1} - x = \frac{1}{\sqrt{x^2+1}+x}
$$


这个形式没有“相近数相减”，数值表现稳定得多。

---

### 🌟 本节你必须掌握

|要点|含义|
|---|---|
|相近数相减是危险操作|会放大误差|
|代数等价不代表数值等价|数值稳定性不同|
|计算公式应尽量避免消去|是算法设计核心原则|