## 🌟 问题背景：为什么需要实现隐式多步法？

在前面的章节中，我们讨论了显式多步法和隐式多步法的区别。显式方法（如 Adams-Bashforth）计算简单，但对于刚性问题，它们的稳定性较差。隐式方法（如 Adams-Moulton）则更加稳定，但需要解方程，因此计算量较大。

隐式多步法的实现通常涉及：

- **隐式公式的求解**
    
- **如何高效地解隐式方程**
    
- **如何保证计算的稳定性**
    

本节主要讨论如何实现这些隐式方法，特别是在数值解常微分方程时遇到的问题。

---

## 🌟 隐式方法的求解：如何处理隐式公式？

隐式方法的迭代公式通常涉及当前点 $y_{n+1}$ 和之前的点 $y_n, y_{n-1}, \dots$。例如，二阶 Adams-Moulton 方法的公式是：

$$
y_{n+1} = y_n + \frac{h}{2} \left( f(t_n, y_n) + f(t_{n+1}, y_{n+1}) \right)
$$


这时，$y_{n+1}$ 同时出现在方程的两边，因此无法直接求解。为了解决这个问题，我们通常需要通过**迭代方法**来解这个方程。

---

## 🌟 解隐式方法：迭代法（Newton-Raphson 方法）

隐式多步法需要通过求解非线性方程来得到 $y_{n+1}$。常用的方法是 **Newton-Raphson 方法**。Newton-Raphson 方法的迭代公式为：

$$
y_{n+1}^{(k+1)} = y_{n+1}^{(k)} - \frac{f(t_{n+1}, y_{n+1}^{(k)})}{J(t_{n+1}, y_{n+1}^{(k)})}
$$


其中：

- $y_{n+1}^{(k)}$ 是第 $k$ 次迭代的值
    
- $J(t_{n+1}, y_{n+1}^{(k)})$ 是雅可比矩阵，表示方程在当前估计点的导数（即如何调整 $y_{n+1}$）
    

该方法通过不断修正 $y_{n+1}$，直到收敛于一个准确值。

---

## 🌟 数值问题：如何处理求解过程中的挑战？

1. **雅可比矩阵的计算**  
    在隐式方法中，我们需要计算 $J(t_{n+1}, y_{n+1}^{(k)})$，这是一个非常重要且计算开销大的步骤。为提高效率，可以选择合适的数值方法来逼近雅可比矩阵，或者使用有限差分法进行近似。
    
2. **收敛性**  
    Newton-Raphson 方法的收敛性通常很好，但在某些情况下，可能会遇到收敛速度慢或不收敛的问题。此时，可以考虑使用更稳定的迭代方法，如 **Broyden 方法** 或 **拟牛顿法**。
    
3. **线性方程求解**  
    在每次迭代中，我们都需要解一个线性方程组。通常采用高效的直接法（如高斯消元法）或者迭代法（如雅可比迭代法）来求解这些方程。
    

---

## 🌟 数值稳定性：如何确保计算稳定？

隐式方法通常具有较好的数值稳定性，特别是在处理刚性问题时。然而，使用这些方法时，仍然需要关注以下问题：

- **步长的选择**：步长太大可能导致不收敛，而步长太小则计算成本过高。通过合适的步长控制策略，可以确保计算在精度和效率之间找到平衡。
    
- **非线性方程的解法**：虽然隐式方法在稳定性上有优势，但每次迭代中涉及非线性方程的求解，这可能会增加计算负担。因此，选择高效的求解算法是至关重要的。
    

---

## 🌟 如何实现隐式多步法：实现步骤

1. **选择隐式公式**  
    根据具体问题的需求，选择合适的隐式多步法，例如 Adams-Moulton 方法或 Backward Differentiation Formula（BDF）。
    
2. **初始化**  
    使用显式方法（如 Runge-Kutta）获得前几个初值 $y_0, y_1, \dots$。
    
3. **迭代求解**  
    使用 Newton-Raphson 或其他迭代方法求解隐式公式中的方程。每次迭代需要计算雅可比矩阵并解线性方程组。
    
4. **步长控制**  
    根据误差估计和稳定性要求调整步长。通常，步长较大时，选择较低的阶数来避免数值不稳定。
    
5. **优化计算**  
    通过预处理、稀疏矩阵技术和并行计算等手段，提高计算效率。
    

---

## 🌟 本节你必须记住的核心结论

|核心点|要义|
|---|---|
|隐式方法的优势|更强的稳定性，适用于刚性问题|
|迭代求解|使用 Newton-Raphson 方法求解隐式公式中的方程|
|雅可比矩阵|计算开销较大，可以通过数值近似来减小计算负担|
|收敛性问题|调整步长和选择稳定的求解方法，确保收敛性|
|步长控制|步长过大会导致不收敛，步长过小则计算成本高|


