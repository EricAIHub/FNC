## 🌟 正规方程的背景

在数据拟合中，我们通过最小化误差平方和来找到最优的拟合函数。对于线性回归模型，即假设数据与自变量之间的关系是线性的，我们希望找到一个线性函数来拟合数据：

$$
y = a_0 + a_1 x_1 + a_2 x_2 + \dots + a_n x_n
$$

其中，$a_0, a_1, \dots, a_n$ 是我们要估计的参数。

为了进行拟合，我们通常使用最小二乘法来最小化拟合误差。正规方程就是通过最小化误差平方和的过程得到的一种求解最优参数的方法。

---

## 🌟 最小二乘法与正规方程

### 🌟 误差平方和的定义

假设我们有 $m$ 个数据点 $(x_1, y_1), (x_2, y_2), \dots, (x_m, y_m)$，我们用函数 $f(x; \mathbf{a})$ 来拟合这些数据，其中 $\mathbf{a} = (a_0, a_1, \dots, a_n)$ 是我们要确定的参数向量。

拟合误差可以表示为：

$$
E(a) = \sum_{i=1}^{m} (y_i - f(x_i; a))^2
$$

最小二乘法的目标是通过调整 $\mathbf{a}$ 来最小化误差平方和，即：

$$
\min_{\mathbf{a}} E(a) = \min_{\mathbf{a}} \sum_{i=1}^{m} (y_i - f(x_i; a))^2
$$


---

### 🌟 导出正规方程

假设我们在进行线性回归时，使用一个线性模型：

$$
y_i = a_0 + a_1 x_{i1} + a_2 x_{i2} + \dots + a_n x_{in} + \epsilon_i
$$


其中，$\epsilon_i$ 是误差项。为了最小化误差平方和，我们将误差平方和表示为：

$$
E(a) = \sum_{i=1}^{m} (y_i - a_0 - a_1 x_{i1} - a_2 x_{i2} - \dots - a_n x_{in})^2
$$


我们将 $E(\mathbf{a})$ 对每个参数 $a_0, a_1, \dots, a_n$ 进行偏导数计算，然后令其为零，得到一组方程，即 **正规方程**：

$$
\mathbf{A}^T \mathbf{A} \mathbf{a} = \mathbf{A}^T \mathbf{b}
$$

这里：

- $\mathbf{A}$ 是 $m \times (n+1)$ 的设计矩阵，其中每行包含一个数据点的所有自变量值。
    
- $\mathbf{a}$ 是包含所有拟合参数的列向量。
    
- $\mathbf{b}$ 是包含所有数据点 $y_i$ 的列向量。
    

---

## 🌟 解释正规方程

正规方程的求解过程可以分为以下几个步骤：

1. **构造设计矩阵 $\mathbf{A}$**：将所有的输入数据 $x_1, x_2, \dots, x_m$ 按照每个数据点的不同特征列排成矩阵 $\mathbf{A}$。
    
    对于线性回归问题，$\mathbf{A}$ 的每行都是一个数据点的特征值向量。
    
    $$
\mathbf{A} = \begin{bmatrix}
1 & x_{11} & x_{12} & \dots & x_{1n} \\
1 & x_{21} & x_{22} & \dots & x_{2n} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
1 & x_{m1} & x_{m2} & \dots & x_{mn}
\end{bmatrix}
$$


    
2. **计算 $\mathbf{A}^T \mathbf{A}$**：这是矩阵 $\mathbf{A}$ 的转置矩阵与 $\mathbf{A}$ 本身的乘积，结果是一个 $n+1 \times n+1$ 的矩阵。
    
3. **计算 $\mathbf{A}^T \mathbf{b}$**：这是设计矩阵 $\mathbf{A}$ 的转置与响应变量 $y$ 向量的乘积，结果是一个 $n+1 \times 1$ 的列向量。
    
4. **求解参数 $\mathbf{a}$**：通过求解正规方程 $\mathbf{A}^T \mathbf{A} \mathbf{a} = \mathbf{A}^T \mathbf{b}$，我们得到最优的拟合参数 $\mathbf{a}$。
    

---

## 🌟 正规方程的计算复杂度

正规方程的求解涉及到两个主要操作：

- 计算 $\mathbf{A}^T \mathbf{A}$，其复杂度为 $O(mn^2)$。
    
- 求解线性方程组 $\mathbf{A}^T \mathbf{A} \mathbf{a} = \mathbf{A}^T \mathbf{b}$，其复杂度为 $O(n^3)$（采用高斯消元法或类似的矩阵分解方法）。
    

因此，正规方程的总计算复杂度为 $O(mn^2 + n^3)$。

---

## 🌟 数值稳定性

正规方程求解时存在一定的数值不稳定性，尤其是当矩阵 $\mathbf{A}^T \mathbf{A}$ 的条件数很大时。具体来说，如果数据矩阵 $\mathbf{A}$ 是病态的（即行列式接近零），则 $\mathbf{A}^T \mathbf{A}$ 可能是奇异的或接近奇异，从而导致解的不稳定性。

为了解决这个问题，通常会选择其他的数值优化方法（如梯度下降法或正则化技术）来避免直接使用正规方程。

---

## 🌟 本节核心总结

| 核心概念       | 要点                                                                               |
| ---------- | -------------------------------------------------------------------------------- |
| **正规方程**   | 用于求解最小二乘问题，通过最小化误差平方和得到拟合参数。                                                     |
| **正规方程推导** | 通过对误差平方和求导得到正规方程：$\mathbf{A}^T \mathbf{A} \mathbf{a} = \mathbf{A}^T \mathbf{b}$。 |
| **计算复杂度**  | 计算 $\mathbf{A}^T \mathbf{A}$ 和求解方程的总复杂度为 $O(mn^2 + n^3)$。                        |
| **数值稳定性**  | 正规方程的求解可能受到矩阵条件数影响，导致数值不稳定。                                                      |
