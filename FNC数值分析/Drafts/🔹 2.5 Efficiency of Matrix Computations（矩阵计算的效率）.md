## 🌟 问题背景：为什么要关心效率？

在数值计算中，我们不仅关心：

- **算得对不对**
    
- 还关心：
    
- **算得快不快**
    
- **占不占内存**
    

尤其是矩阵规模一大，算法效率直接决定问题能不能算完。

---

## 🌟 基本成本单位：浮点运算（flop）

我们用 **flop（floating-point operation）** 作为基本工作量单位：

- 一次加法 = 1 flop
    
- 一次乘法 = 1 flop
    

👉 一个乘加大约算 2 flops。

---

## 🌟 矩阵–向量乘法的复杂度

如果：

- $\mathbf{A}$ 是 $m \times n$
    
- $\mathbf{x}$ 是 $n$ 维向量
    

计算：

$$
\mathbf{y}=\mathbf{A}\mathbf{x}
$$


每个分量：

$$
y_i=\sum_{j=1}^n A_{ij}x_j
$$


需要：

- $n$ 次乘加
    
- 一共 $m$ 个分量
    

所以成本是：

$$
O(mn)
$$


---

## 🌟 矩阵–矩阵乘法的复杂度

如果：

- $\mathbf{A}$ 是 $m \times n$
    
- $\mathbf{B}$ 是 $n \times p$
    

计算：

$$
\mathbf{C}=\mathbf{A}\mathbf{B}
$$


每个元素：

$$
C_{ij}=\sum_{k=1}^n A_{ik}B_{kj}
$$


需要：

- $n$ 次乘加
    
- 一共 $m \times p$ 个元素
    

所以总成本是：

$$
O(mnp)
$$


👉 若 $m=n=p=N$，则是：

$$
O(n^3)
$$


---

## 🌟 LU 分解的计算成本

LU 分解通过高斯消元完成。

对于 $n \times n$ 矩阵：

- 第 1 列消元：约 $n^2$ 次操作
    
- 第 2 列消元：约 $(n-1)^2$ 次操作
    
- ……
    

总成本约为：

$$
\frac{2}{3}n^3 \ \text{flops}
$$


因此：

$$
\text{LU 分解成本}=O(n^3)
$$


---

## 🌟 解线性系统的真实成本结构

如果我们要解：

$$
\mathbf{A}\mathbf{x}=\mathbf{b}
$$


### 🌟 方式一：每次都重新消元（很慢）

每次都做 LU 分解：

$$
O(n^3)
$$


---

### 🌟 方式二：一次 LU，多次右端（很快）

先算一次：

$$
\mathbf{A}=\mathbf{L}\mathbf{U}
$$


之后每个新 $\mathbf{b}$：

- 解 $\mathbf{L}\mathbf{y}=\mathbf{b}$：$O(n^2)$
    
- 解 $\mathbf{U}\mathbf{x}=\mathbf{y}$：$O(n^2)$
    

所以：

👉 **一次预处理 $O(n^3)$，每次新求解 $O(n^2)$**

这在工程和科学计算中极其重要。

---

## 🌟 内存访问比运算更慢（现代计算机现实）

在现代硬件中：

- **内存访问成本 > 浮点运算成本**
    

因此：

- 连续访问数据（向量化）
    
- 使用块算法（blocking）
    

往往比减少几次乘法更重要。

---

## 🌟 数值线性代数中的经验法则

|问题规模|推荐策略|
|---|---|
|小规模|直接方法（LU、QR）|
|中规模|稳定直接法 + 高效实现|
|超大规模|迭代法（后续章节）|

---

## 🌟 本节你必须记住（核心总结）

🌟 **矩阵–向量乘法：$O(mn)$**

🌟 **矩阵–矩阵乘法：$O(mnp)$，方阵是 $O(n^3)$**

🌟 **LU 分解：$O(n^3)$**

🌟 **三角系统求解：$O(n^2)$**

🌟 **一次 LU，多次求解特别划算**

🌟 **现代计算中：内存访问往往比算术更贵**